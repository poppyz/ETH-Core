# ETH-Core
该项目主要是为了熟悉区块链的使用 

# 项目介绍
开发该项目的目的是因为对区块链知识比较好奇，但又觉得只看介绍不容易理解所以我做了该系统，


- 环境配置
一开始我通过编译ETH client go版本运行后 我发现 不容易管理，而且我只有一个电脑 组网配置非常麻烦。之后我使用docker 通过建立虚拟网卡的方式创建了四个节点

| 节点名称  | 存在形式|  位置      |    IP         |  RPC Port|  P2P Port |  描述     |
| --------  | -----:  | :----:     |   :----:      | :----:   |    :----: | -----:    |
| Node0     | Docker  |  Local     | 130.100.0.10  |    8546  |    30303 | 主节点     |
| Node1     | Docker  |  Local     | 130.100.0.11  |    8546  |    30303 | 从节点     |
| Miner0    | Docker  |  Local     | 130.100.100.1 |    NULL  |    30303 | 挖矿节点   |
| Node2     | Docker  |  亚马逊云  | 35.72.63.205  |    NULL  |    30303 | 备份节点   |

Node 2 存在的意义在于 我对区块链不熟悉 经常做一些不可挽回的操作比如 有时候重启节点就无法同步 且显示高度为0  有时候我创建很多交易污染了区块链。而且 因为其他节点都以Docker的形式存在于我的电脑，可能会死机造成数据损坏。所以我在
亚马逊云端开启了一个服务器专门用来同部数据（亚马逊带宽不限）。当我需要进行一些不确定性的操作时候 我临时断开与Node2的连接然后确定没问题之后才会重连让亚马逊的服务器同步本地的数据，如果有问题则删除本地节点数据等待从Node2节点同步
否则我对区块链本身也是刚接触 每次都要重新建立节点重新做数据实在太浪费时间了 其实浪费了大概一周多 到现在也没解决。只能取巧了

- 创建的流程[链接](https://github.com/poppyz/ETH-Core/blob/master/Doc/%E4%BD%BF%E7%94%A8Docker%20%E6%90%AD%E5%BB%BAETH%E7%A7%81%E6%9C%89%E9%93%BE%E9%9B%86%E7%BE%A4.md)

创建好集群之后 我为了丰富链上数据。我创建了 2,000,000 (2M)个账户(使用了多线程以及为了防止内存不足使用文件流作为缓存)   //因为是CPU密集型 所以只使用了 8 线程

之后我使用节点的配置文件中的预设账户 对 两百万个新生账户进行了 布施 向每个账户发送 1ETH . 并成功上链 （此时出现问题，因为Gas Limit 和 Gas Price 我设置的是固定值 虽然是多线程创建并发送交易 但我Nonce是原子自增的，我觉得没问题，但是执行一段时间就会出现交易全堆积在Node0的Pending队列，然后在Miner0节点上会卡在QUEUE队列上，原因可能是Gas Price 是根据连续一段时间交易的数量动态调节的，但是我不确定 我也没找到答案 所以我基本上都是清空Node0然后等待同步成功之后再发送交易 此时因为Nonce 一样会把 Miner0 的交易顶替掉 循环往复 ）

到此时 这个ETH集群拥有了一条包含 2,000,005 条交易的区块链 此时我的项目开发刚刚开始 ~~~~

该系统主要实现了以下功能

* 通过配置文件连接GETH节点
 + [x] HTTP
 + [x] WebSocket
 + [x] IPC
* 账户
 + [x] 通过密钥、随机值创建账户
 + [x] 支持多线程大批量创建(百万级以上)
 + [x] 上传到Mongodb 保存
* 交易
 + [x] 原始交易的创建
 + [x] 交易签名
 + [x] 交易的发送
 + [x] 交易的状态查询
 + [x] 支持设定速度自动随机发送交易 (为了模拟正常的ETH网络)
 + [x] 实时获取已上链交易 上传到Mongodb 保存
* 消息订阅
 + [x] 订阅历史块 实时获取已打包的区块 上传到Mongodb 保存
 + [x] 订阅Pending交易
 + [x] 订阅已上链交易 上传到Mongodb 保存
* 合约相关
 + [x] 合约的创建
 + [x] 合约的部署
 + [ ] 合约的调用